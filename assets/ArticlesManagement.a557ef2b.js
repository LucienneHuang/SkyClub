import{Q as M}from"./QImg.ad42b8d5.js";import{_ as te,s as p,a8 as D,K as ae,b as T,o as c,c as le,f as a,k as o,e as r,Z as I,X as m,F as oe,a0 as A,aS as ie,i as y,Q as F,z as S,$ as u,t as N,a as re,a1 as O,a2 as se,a3 as ne}from"./index.6b2ef3fc.js";import{a as R,Q as n}from"./QCard.01c9b97b.js";import{Q as g}from"./QInput.c7070f2e.js";import{Q as $}from"./QSelect.26f468d5.js";import{Q as de,a as me}from"./QPopupProxy.f454faf2.js";import{Q as ue}from"./QEditor.6067de99.js";import{Q as pe}from"./use-fullscreen.77e75583.js";import{Q as L}from"./QCardActions.0059a631.js";import{Q as ce}from"./QForm.d7de5f48.js";import{Q as E}from"./QDialog.4e69bc71.js";import{Q as ge,a as fe,b as _}from"./QResponsive.b5667dff.js";import{C as U}from"./ClosePopup.b80770d6.js";import{u as ye}from"./use-quasar.e36b9b6f.js";/* empty css                */import"./use-ratio.361238d7.js";import"./use-dark.b9c2cd61.js";import"./focus-manager.a1b6aa0a.js";import"./QChip.c6011778.js";import"./QItem.71993566.js";import"./QMenu.d1bd172d.js";import"./scroll.21392c10.js";import"./focusout.782fe8c3.js";import"./rtl.b51694b1.js";import"./format.865294d5.js";import"./use-prevent-scroll.7839fac3.js";import"./QList.6780d653.js";import"./QMarkupTable.2d2035d1.js";const d=v=>(se("data-v-232d0ee8"),v=v(),ne(),v),_e={id:"form"},ve=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u6A19\u984C",-1)),be=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u5F15\u6587",-1)),we=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u5206\u985E",-1)),he=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u5340\u57DF",-1)),qe=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u539F\u6587",-1)),Ve=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u7FFB\u8B6F",-1)),xe=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u65E5\u671F",-1)),ke={class:"row items-center justify-end"},Qe=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u5167\u6587",-1)),Ce=d(()=>r("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u986F\u793A",-1)),ze=d(()=>r("div",{class:"text-center text-h6"},"\u78BA\u5B9A\u8981\u522A\u9664\u55CE\uFF1F",-1)),Ie={id:"title",class:"q-ml-xl q-my-lg q-pl-lg q-py-sm text-h4 text-weight-bold non-selectable"},Ae={id:"container",class:"flex justify-center q-px-xl q-pb-xl"},Fe={__name:"ArticlesManagement",setup(v){const s=ye(),b=p(""),P=[{name:"date",required:!0,label:"\u767C\u5E03\u65E5\u671F",align:"center",field:"date",sortable:!0},{name:"category",required:!0,label:"\u5206\u985E",align:"center",field:"category",sortable:!0},{name:"image",required:!0,label:"\u9996\u5716",align:"center",field:"image",sortable:!1},{name:"title",required:!0,label:"\u6587\u7AE0\u6A19\u984C",align:"left",field:"title",sortable:!1},{name:"display",required:!0,label:"\u986F\u793A",align:"center",field:"display",sortable:!0},{name:"edit",required:!0,label:"\u7DE8\u8F2F",align:"center",field:"edit",sortable:!1},{name:"delete",required:!0,label:"\u522A\u9664",align:"center",field:"delete",sortable:!1}],C=D([]),w=async()=>{try{const{data:l}=await A.get("/articles/all",{params:{search:b.value}});C.splice(0,C.length,...l.result)}catch(l){s.notify({type:"negative",message:l.response.data.message})}};w();const W=["\u6700\u65B0\u6D88\u606F","\u5340\u57DF\u4ECB\u7D39"],G=["\u7121","\u6668\u5CF6","\u96F2\u91CE","\u96E8\u6797","\u971E\u8C37","\u66AE\u571F","\u7981\u95A3"],f={required:l=>!!l||"\u6B04\u4F4D\u5FC5\u586B",categoryRequired:l=>["\u6700\u65B0\u6D88\u606F","\u5340\u57DF\u4ECB\u7D39"].includes(l)||"\u6C92\u6709\u8A72\u5206\u985E",realmsRequired:l=>["\u7121","\u6668\u5CF6","\u96F2\u91CE","\u96E8\u6797","\u971E\u8C37","\u66AE\u571F","\u7981\u95A3"].includes(l)||"\u6C92\u6709\u8A72\u5206\u985E"},h=p(!1),K=()=>{h.value=!h.value},q=p(!1),V=p(!1),x=p(""),z=p([]),t=D({title:"",original:"",translation:"",date:"",image:[],oldImg:"",description:"",category:"",realms:"",quote:"",display:!1}),X=l=>{q.value=!0,t.title=l.title,t.original=l.original,t.translation=l.translation,t.date=l.date,t.description=l.description,t.image=l.image,t.category=l.category,t.realms=l.realms,t.quote=l.quote,t.display=l.display,t.oldImg=l.image,x.value=l._id},Z=async()=>{try{const l=new FormData;l.append("title",t.title),l.append("original",t.original),l.append("translation",t.translation),l.append("date",t.date),l.append("description",t.description),l.append("category",t.category),l.append("realms",t.realms),l.append("quote",t.quote),l.append("display",t.display),t.image.length===0||typeof t.image=="string"?l.append("image",t.oldImg):l.append("image",t.image[0].file),await A.patch("/articles/"+x.value,l),await O.fire({icon:"success",title:"\u66F4\u65B0\u6210\u529F",showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"},iconColor:"#F198AF",confirmButtonColor:"#F198AF",width:"20rem"}),z.value="",t.image="",h.value=!1,w()}catch(l){s.notify({type:"negative",message:l.response.data.message})}},H=async l=>{V.value=!0,x.value=l._id},J=async()=>{try{await A.delete("/articles/"+x.value),await O.fire({icon:"success",title:"\u522A\u9664\u6210\u529F",showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"},iconColor:"#F198AF",confirmButtonColor:"#F198AF",width:"20rem"}),w()}catch(l){s.notify({type:"negative",message:l.response.data.message})}},k=p(""),Q=p(""),B=()=>{window.innerWidth>975?(k.value=12,Q.value=5):window.innerWidth>1200?(k.value=5,Q.value=5):(k.value=2,Q.value=2)};return B(),window.addEventListener("resize",()=>{B()}),ae(b,async(l,i)=>{w()}),(l,i)=>{const Y=T("VueFileAgent"),j=T("router-link");return c(),le(oe,null,[a(E,{modelValue:q.value,"onUpdate:modelValue":i[13]||(i[13]=e=>q.value=e),persistent:""},{default:o(()=>[r("div",_e,[a(ce,{onSubmit:ie(Z,["prevent"])},{default:o(()=>[a(R,{class:"flex column justify-center items-center q-pa-lg q-ma-xl"},{default:o(()=>[a(n,{horizontal:""},{default:o(()=>[h.value?(c(),y(Y,{key:0,maxSize:"1MB",deletable:!0,accept:"image/jpg,image/jpeg,image/png",helpText:"\u53EA\u63A5\u53D7 jpg, jpeg \u6216 png \u6A94",modelValue:t.image,"onUpdate:modelValue":i[0]||(i[0]=e=>t.image=e),rawModelValue:z.value,"onUpdate:rawModelValue":i[1]||(i[1]=e=>z.value=e),errorText:{type:"\u6A94\u6848\u985E\u578B\u4E0D\u5408\u6CD5\u3002\u53EA\u63A5\u53D7 jpg, jpeg \u6216 png \u6A94\u3002",size:"\u6A94\u6848\u5927\u5C0F\u4E0D\u5F97\u5927\u65BC1MB"}},null,8,["modelValue","rawModelValue"])):(c(),y(m,{key:1,onClick:K},{default:o(()=>[a(M,{src:t.oldImg,style:{width:"160px",height:"160px","border-radius":"0"}},null,8,["src"])]),_:1}))]),_:1}),a(n,{horizontal:""},{default:o(()=>[ve,a(g,{label:"\u8ACB\u8F38\u5165\u6A19\u984C",color:"primary",type:"text",modelValue:t.title,"onUpdate:modelValue":i[2]||(i[2]=e=>t.title=e)},null,8,["modelValue"])]),_:1}),a(n,{horizontal:""},{default:o(()=>[be,a(g,{label:"(\u9078\u586B)",color:"primary",type:"text",modelValue:t.quote,"onUpdate:modelValue":i[3]||(i[3]=e=>t.quote=e)},null,8,["modelValue"])]),_:1}),a(n,{horizontal:"",id:"select"},{default:o(()=>[we,a($,{options:W,label:"\u6587\u7AE0\u5206\u985E",rules:[f.required,f.categoryRequired],modelValue:t.category,"onUpdate:modelValue":i[4]||(i[4]=e=>t.category=e)},null,8,["rules","modelValue"]),he,a($,{options:G,label:"\u5340\u57DF\u5206\u985E",rules:[f.required,f.realmsRequired],modelValue:t.realms,"onUpdate:modelValue":i[5]||(i[5]=e=>t.realms=e)},null,8,["rules","modelValue"])]),_:1}),a(n,{horizontal:""},{default:o(()=>[qe,a(g,{label:"\u8ACB\u8F38\u5165\u539F\u6587\u7DB2\u5740",color:"primary",type:"text",modelValue:t.original,"onUpdate:modelValue":i[6]||(i[6]=e=>t.original=e)},null,8,["modelValue"])]),_:1}),a(n,{horizontal:""},{default:o(()=>[Ve,a(g,{label:"\u8ACB\u8F38\u5165\u7FFB\u8B6F\u4F86\u6E90",color:"primary",type:"text",modelValue:t.translation,"onUpdate:modelValue":i[7]||(i[7]=e=>t.translation=e)},null,8,["modelValue"])]),_:1}),a(n,{horizontal:""},{default:o(()=>[xe,a(g,{label:"\u8ACB\u8F38\u5165\u6587\u7AE0\u65E5\u671F",modelValue:t.date,"onUpdate:modelValue":i[9]||(i[9]=e=>t.date=e),mask:"date",rules:["date"]},{append:o(()=>[a(F,{name:"event",class:"cursor-pointer"},{default:o(()=>[a(de,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(me,{modelValue:t.date,"onUpdate:modelValue":i[8]||(i[8]=e=>t.date=e)},{default:o(()=>[r("div",ke,[S(a(m,{label:"Close",color:"primary",flat:""},null,512),[[U]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(n,{horizontal:""},{default:o(()=>[Qe,a(ue,{rules:[f.required],modelValue:t.description,"onUpdate:modelValue":i[10]||(i[10]=e=>t.description=e),"max-height":"20rem",class:"q-my-md",dense:u(s).screen.lt.md,toolbar:[[{label:u(s).lang.editor.align,icon:u(s).iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],[{label:u(s).lang.editor.formatting,icon:u(s).iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:u(s).lang.editor.fontSize,icon:u(s).iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:u(s).lang.editor.defaultFont,icon:u(s).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["rules","modelValue","dense","toolbar"])]),_:1}),a(n,{horizontal:""},{default:o(()=>[Ce,a(pe,{class:"q-mt-sm",color:"primary",modelValue:t.display,"onUpdate:modelValue":i[11]||(i[11]=e=>t.display=e)},null,8,["modelValue"])]),_:1}),a(L,{class:"q-mt-sm"},{default:o(()=>[S(a(m,{type:"submit",unelevated:"",rounded:"",style:{width:"6rem"},size:"1rem",color:"primary",label:"\u9001\u51FA"},null,512),[[U]]),a(m,{unelevated:"",rounded:"",style:{width:"6rem"},size:"1rem",outline:"",color:"primary",label:"\u53D6\u6D88",onClick:i[12]||(i[12]=e=>q.value=!1)})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])]),_:1},8,["modelValue"]),a(E,{modelValue:V.value,"onUpdate:modelValue":i[15]||(i[15]=e=>V.value=e),persistent:""},{default:o(()=>[a(R,null,{default:o(()=>[a(n,null,{default:o(()=>[ze]),_:1}),a(L,null,{default:o(()=>[S(a(m,{type:"submit",unelevated:"",rounded:"",style:{width:"6rem"},size:"1rem",color:"primary",label:"\u78BA\u5B9A",onClick:J},null,512),[[U]]),a(m,{unelevated:"",rounded:"",style:{width:"6rem"},size:"1rem",outline:"",color:"primary",label:"\u53D6\u6D88",onClick:i[14]||(i[14]=e=>V.value=!1)})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("div",Ie,[I("\u6240\u6709\u6587\u7AE0\u7BA1\u7406 "),a(m,{class:"q-mb-sm",round:"",color:"primary",icon:"mdi-plus-thick",to:"/admin/addarticle"})]),r("div",Ae,[a(ge,{id:"wh",ratio:k.value/Q.value},{default:o(()=>[a(fe,{"rows-per-page-options":[10,0],columns:P,"row-key":"name",rows:C},{"top-right":o(()=>[a(g,{color:"white",filled:"",clearable:"",borderless:"",dense:"",debounce:"300",modelValue:b.value,"onUpdate:modelValue":i[16]||(i[16]=e=>b.value=e),placeholder:"\u8ACB\u8F38\u5165\u6587\u7AE0\u95DC\u9375\u5B57"},{append:o(()=>[a(F,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-image":o(e=>[a(_,{props:e},{default:o(()=>[a(M,{src:e.value,"spinner-color":"white",style:{height:"140px",width:"180px"}},null,8,["src"])]),_:2},1032,["props"])]),"body-cell-title":o(e=>[a(_,{props:e},{default:o(()=>[e.row.category==="\u6700\u65B0\u6D88\u606F"?(c(),y(j,{key:0,to:"/latestnews/"+e.row.category+"?articleId="+e.row._id},{default:o(()=>[I(N(e.row.title),1)]),_:2},1032,["to"])):(c(),y(j,{key:1,to:"/realms/"+e.row.category+"?articleId="+e.row._id},{default:o(()=>[I(N(e.row.title),1)]),_:2},1032,["to"]))]),_:2},1032,["props"])]),"body-cell-display":o(e=>[a(_,{props:e},{default:o(()=>[e.value?(c(),y(F,{key:0,name:"mdi-check"})):re("",!0)]),_:2},1032,["props"])]),"body-cell-edit":o(e=>[a(_,{props:e},{default:o(()=>[a(m,{round:"",color:"primary",onClick:ee=>X(e.row),icon:"mdi-file-document-edit"},null,8,["onClick"])]),_:2},1032,["props"])]),"body-cell-delete":o(e=>[a(_,{props:e},{default:o(()=>[a(m,{round:"",color:"primary",onClick:ee=>H(e.row),icon:"mdi-delete"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1},8,["ratio"])])],64)}}};var rt=te(Fe,[["__scopeId","data-v-232d0ee8"]]);export{rt as default};
