import{Q as z}from"./QImg.18ef33fa.js";import{_ as J,s as c,a8 as U,K as W,b as B,o as n,c as C,f as t,k as r,e as u,Z as F,X as p,F as D,a0 as R,aS as Y,i as g,$ as m,r as ee,a as S,z as ae,Q as A,t as le,a1 as te,a2 as oe,a3 as re}from"./index.e5ac4a96.js";import{a as se,Q as d}from"./QCard.4acf99d4.js";import{Q as V}from"./QInput.64d79ec0.js";import{Q as T}from"./QSelect.8c4137b3.js";import{Q as ie}from"./QEditor.9696e740.js";import{Q as ne}from"./use-fullscreen.492d1408.js";import{Q as P}from"./QCardActions.24dfeaed.js";import{Q as de}from"./QForm.c6f386f2.js";import{Q as ue}from"./QDialog.84f7d885.js";import{Q as me,a as ce,b as I}from"./QResponsive.accc16d0.js";import{C as pe}from"./ClosePopup.9e3b4d79.js";import{u as ge}from"./use-quasar.52f987cc.js";/* empty css                */import"./use-ratio.9ff96154.js";import"./use-dark.fe7559c7.js";import"./focus-manager.a1b6aa0a.js";import"./QChip.bce8ae34.js";import"./QItem.2669ee84.js";import"./QMenu.ae70849c.js";import"./scroll.dcfe61b8.js";import"./focusout.724155a4.js";import"./rtl.b51694b1.js";import"./format.865294d5.js";import"./use-prevent-scroll.422bcab0.js";import"./QList.4843271d.js";import"./QMarkupTable.1a10989f.js";const f=_=>(oe("data-v-c4cd9ad6"),_=_(),re(),_),fe={id:"form"},ye=f(()=>u("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u6A19\u984C",-1)),be=f(()=>u("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u91D1\u984D",-1)),_e=f(()=>u("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u5E63\u503C",-1)),ve=f(()=>u("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u6578\u91CF",-1)),he=f(()=>u("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u5167\u6587",-1)),xe=f(()=>u("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u5206\u985E",-1)),qe=f(()=>u("div",{class:"text-h7 q-mt-md q-mr-lg"},"\u4E0A\u67B6",-1)),we={key:1},Ve={id:"title",class:"q-ml-xl q-my-lg q-pl-lg q-py-sm text-h4 text-weight-bold non-selectable"},Ie={id:"container",class:"flex justify-center q-px-xl q-pb-xl"},ke={__name:"MemberProductsManagement",setup(_){const s=ge(),v=c(""),h=c(6),y=c(!1),E=()=>{y.value=!y.value,y.value===!0?s.notify({type:"positive",message:"\u52A0\u4E0A\u5DF2\u4E0A\u50B3\uFF0C\u6700\u591A\u516D\u5F35\u3002"}):s.notify({type:"negative",message:"\u53D6\u6D88"})},L=[{name:"image",required:!0,label:"\u5716\u7247",align:"center",field:"image",sortable:!1},{name:"name",required:!0,label:"\u540D\u7A31",align:"center",field:"name",sortable:!0},{name:"price",required:!0,label:"\u50F9\u683C",align:"center",field:"price",sortable:!0},{name:"MaxNumber",required:!0,label:"\u6578\u91CF",align:"center",field:"MaxNumber",sortable:!0},{name:"category",required:!0,label:"\u5206\u985E",align:"center",field:"category",sortable:!0},{name:"sell",required:!0,label:"\u4E0A\u67B6",align:"center",field:"sell",sortable:!0},{name:"edit",required:!0,label:"\u7DE8\u8F2F",align:"center",field:"edit",sortable:!1}],k=U([]),M=async()=>{try{const{data:a}=await R.get("/products/own",{params:{search:v.value}});k.splice(0,k.length,...a.result)}catch(a){s.notify({type:"negative",message:a.response.data.message})}};M();const i={required:a=>!!a||"\u6B04\u4F4D\u5FC5\u586B",numberRequired:a=>!isNaN(a)&&a>0||"\u4E0D\u5F97\u5C0F\u65BC 0",currencyRequired:a=>["\u53F0\u5E63"].includes(a)||"\u6C92\u6709\u8A72\u5E63\u503C",categoryRequired:a=>["\u5B63\u7968","\u79AE\u5305","\u5468\u908A","\u5176\u4ED6"].includes(a)||"\u6C92\u6709\u8A72\u5206\u985E"},b=c(!1),O=()=>{b.value=!b.value},Q=c([]),x=c([]),e=U({image:[],images:[],oldImg:"",oldImgs:[],name:"",price:0,currency:"",MaxNumber:0,description:"",category:"",sell:!1}),$=["\u53F0\u5E63"],G=["\u5B63\u7968","\u79AE\u5305","\u5468\u908A","\u5176\u4ED6"],q=c(!1),N=c(""),K=a=>{b.value=!1,y.value=!1,q.value=!0,e.image=a.image,e.images=[],x.value=[],e.oldImg=a.image,e.oldImgs=[...a.images],e.name=a.name,e.price=a.price,e.currency=a.currency,e.MaxNumber=a.MaxNumber,e.description=a.description,e.category=a.category,e.sell=a.sell,N.value=a._id,h.value=6-a.images.length},X=a=>{const o=e.oldImgs.findIndex(w=>w===a);e.oldImgs.splice(o,1),h.value=6-e.oldImgs.length},Z=async()=>{try{const a=new FormData;a.append("name",e.name),a.append("price",e.price),a.append("currency",e.currency),a.append("MaxNumber",e.MaxNumber),a.append("description",e.description),a.append("category",e.category),a.append("sell",e.sell),e.image.length===0||typeof e.image=="string"?a.append("image",e.oldImg):a.append("image",e.image[0].file),e.images.length>=1&&e.images.forEach(o=>{a.append("images",o.file)}),e.oldImgs.length>=1&&e.oldImgs.forEach(o=>{a.append("oldImgs",o)}),await R.patch("/products/"+N.value,a),await te.fire({icon:"success",title:"\u66F4\u65B0\u6210\u529F",showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"},iconColor:"#A6D8D4",confirmButtonColor:"#A6D8D4",width:"20rem"}),Q.value="",x.value=[],e.image=[],e.images=[],b.value=!1,M()}catch(a){s.notify({type:"negative",message:a.response.data.message})}};return W(v,async(a,o)=>{M()}),(a,o)=>{const w=B("VueFileAgent"),H=B("router-link");return n(),C(D,null,[t(ue,{modelValue:q.value,"onUpdate:modelValue":o[12]||(o[12]=l=>q.value=l),persistent:""},{default:r(()=>[u("div",fe,[t(de,{onSubmit:Y(Z,["prevent"])},{default:r(()=>[t(se,{class:"flex column justify-center items-center q-pa-lg q-ma-xl"},{default:r(()=>[t(d,{horizontal:""},{default:r(()=>[b.value?(n(),g(w,{key:0,maxSize:"1MB",deletable:!0,accept:"image/jpg,image/jpeg,image/png",helpText:"\u53EA\u63A5\u53D7 jpg, jpeg \u6216 png \u6A94",modelValue:e.image,"onUpdate:modelValue":o[0]||(o[0]=l=>e.image=l),rawModelValue:Q.value,"onUpdate:rawModelValue":o[1]||(o[1]=l=>Q.value=l),errorText:{type:"\u6A94\u6848\u985E\u578B\u4E0D\u5408\u6CD5\u3002\u53EA\u63A5\u53D7 jpg, jpeg \u6216 png \u6A94\u3002",size:"\u6A94\u6848\u5927\u5C0F\u4E0D\u5F97\u5927\u65BC1MB"}},null,8,["modelValue","rawModelValue"])):(n(),g(p,{key:1,onClick:O},{default:r(()=>[t(z,{src:e.oldImg,style:{width:"160px",height:"160px","border-radius":"0"}},null,8,["src"])]),_:1}))]),_:1}),t(d,{horizontal:""},{default:r(()=>[ye,t(V,{color:"secondary",type:"text",modelValue:e.name,"onUpdate:modelValue":o[2]||(o[2]=l=>e.name=l),rules:[i.required]},null,8,["modelValue","rules"])]),_:1}),t(d,{horizontal:""},{default:r(()=>[be,t(V,{color:"secondary",type:"number",modelValue:e.price,"onUpdate:modelValue":o[3]||(o[3]=l=>e.price=l),modelModifiers:{number:!0},rules:[i.required,i.numberRequired]},null,8,["modelValue","rules"])]),_:1}),t(d,{horizontal:""},{default:r(()=>[_e,t(T,{color:"secondary",modelValue:e.currency,"onUpdate:modelValue":o[4]||(o[4]=l=>e.currency=l),options:$,label:"\u5E63\u503C",rules:[i.required,i.currencyRequired]},null,8,["modelValue","rules"])]),_:1}),t(d,{horizontal:""},{default:r(()=>[ve,t(V,{color:"secondary",type:"number",modelValue:e.MaxNumber,"onUpdate:modelValue":o[5]||(o[5]=l=>e.MaxNumber=l),modelModifiers:{number:!0},rules:[i.required,i.numberRequired]},null,8,["modelValue","rules"])]),_:1}),t(d,{horizontal:""},{default:r(()=>[he,t(ie,{"max-height":"20rem",rules:[i.required],modelValue:e.description,"onUpdate:modelValue":o[6]||(o[6]=l=>e.description=l),class:"q-my-md",dense:m(s).screen.lt.md,toolbar:[[{label:m(s).lang.editor.align,icon:m(s).iconSet.editor.align,fixedLabel:!0,list:"only-icons",options:["left","center","right","justify"]}],["bold","italic","strike","underline","subscript","superscript"],["token","hr","link","custom_btn"],[{label:m(s).lang.editor.formatting,icon:m(s).iconSet.editor.formatting,list:"no-icons",options:["p","h1","h2","h3","h4","h5","h6","code"]},{label:m(s).lang.editor.fontSize,icon:m(s).iconSet.editor.fontSize,fixedLabel:!0,fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},{label:m(s).lang.editor.defaultFont,icon:m(s).iconSet.editor.font,fixedIcon:!0,list:"no-icons",options:["default_font","arial","arial_black","comic_sans","courier_new","impact","lucida_grande","times_new_roman","verdana"]},"removeFormat"],["quote","unordered","ordered"],["undo","redo"],["viewsource"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"}},null,8,["rules","modelValue","dense","toolbar"])]),_:1}),t(d,{horizontal:""},{default:r(()=>[xe,t(T,{color:"secondary",modelValue:e.category,"onUpdate:modelValue":o[7]||(o[7]=l=>e.category=l),options:G,label:"\u5206\u985E",rules:[i.required,i.categoryRequired]},null,8,["modelValue","rules"])]),_:1}),t(d,{horizontal:""},{default:r(()=>[qe,t(ne,{class:"q-mt-sm",color:"secondary",modelValue:e.sell,"onUpdate:modelValue":o[8]||(o[8]=l=>e.sell=l)},null,8,["modelValue"])]),_:1}),t(P,{class:"q-mt-sm"},{default:r(()=>[t(p,{unelevated:"",rounded:"",style:{width:"6rem"},size:"1rem",outline:"",color:"secondary",label:"\u66F4\u591A\u5716\u7247",onClick:E})]),_:1}),e.oldImgs.length>=1?(n(),g(d,{key:0,class:"flex justify-center"},{default:r(()=>[(n(!0),C(D,null,ee(e.oldImgs,(l,j)=>(n(),g(p,{key:j,onClick:Me=>X(l)},{default:r(()=>[t(z,{src:l,style:{width:"160px",height:"160px","border-radius":"0"}},null,8,["src"])]),_:2},1032,["onClick"]))),128))]),_:1})):S("",!0),y.value?(n(),g(d,{key:1,horizontal:""},{default:r(()=>[h.value>0?(n(),g(w,{key:0,multiple:!0,maxFiles:h.value,maxSize:"1MB",deletable:!0,accept:"image/jpg,image/jpeg,image/png",helpText:"\u53EA\u63A5\u53D7 jpg, jpeg \u6216 png \u6A94\uFF0C\u52A0\u4E0A\u5DF2\u4E0A\u50B3\uFF0C\u6700\u591A\u516D\u5F35\u3002",modelValue:e.images,"onUpdate:modelValue":o[9]||(o[9]=l=>e.images=l),errorText:{type:"\u6A94\u6848\u985E\u578B\u4E0D\u5408\u6CD5\u3002\u53EA\u63A5\u53D7 jpg, jpeg \u6216 png \u6A94\u3002",size:"\u6A94\u6848\u5927\u5C0F\u4E0D\u5F97\u5927\u65BC1MB"},rawModelValue:x.value,"onUpdate:rawModelValue":o[10]||(o[10]=l=>x.value=l)},null,8,["maxFiles","modelValue","rawModelValue"])):(n(),C("div",we,"\u5716\u7247\u6700\u591A\u516D\u5F35\uFF0C\u8ACB\u522A\u9664\u5716\u7247\u518D\u65B0\u589E\u3002"))]),_:1})):S("",!0),t(P,{class:"q-mt-sm"},{default:r(()=>[ae(t(p,{type:"submit",unelevated:"",rounded:"",style:{width:"6rem"},size:"1rem",color:"secondary",label:"\u9001\u51FA"},null,512),[[pe]]),t(p,{unelevated:"",rounded:"",style:{width:"6rem"},size:"1rem",outline:"",color:"secondary",label:"\u53D6\u6D88",onClick:o[11]||(o[11]=l=>q.value=!1)})]),_:1})]),_:1})]),_:1},8,["onSubmit"])])]),_:1},8,["modelValue"]),u("div",Ve,[F("\u500B\u4EBA\u5546\u54C1\u7BA1\u7406 "),t(p,{class:"q-mb-sm",round:"",color:"secondary",icon:"mdi-plus-thick",to:"/member/addproduct"})]),u("div",Ie,[t(me,{id:"wh",ratio:8/5},{default:r(()=>[t(ce,{columns:L,"row-key":"_id",rows:k},{"top-right":r(()=>[t(V,{color:"white",filled:"",clearable:"",borderless:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":o[13]||(o[13]=l=>v.value=l),placeholder:"\u8ACB\u8F38\u5165\u5546\u54C1\u95DC\u9375\u5B57"},{append:r(()=>[t(A,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-image":r(l=>[t(I,{props:l},{default:r(()=>[t(z,{src:l.value,"spinner-color":"white",style:{height:"140px",width:"180px"}},null,8,["src"])]),_:2},1032,["props"])]),"body-cell-name":r(l=>[t(I,{props:l},{default:r(()=>[t(H,{to:"/trade/"+l.row._id},{default:r(()=>[F(le(l.row.name),1)]),_:2},1032,["to"])]),_:2},1032,["props"])]),"body-cell-sell":r(l=>[t(I,{props:l},{default:r(()=>[l.value?(n(),g(A,{key:0,name:"mdi-check"})):S("",!0)]),_:2},1032,["props"])]),"body-cell-edit":r(l=>[t(I,{props:l},{default:r(()=>[t(p,{round:"",color:"secondary",onClick:j=>K(l.row),icon:"mdi-file-document-edit"},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})])],64)}}};var aa=J(ke,[["__scopeId","data-v-c4cd9ad6"]]);export{aa as default};
